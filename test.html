<!DOCTYPE html>
<html>
  <head>
    <script src="node_modules/foam2/src/foam.js"></script>
		<script src="lib/grid_dao.es6.js"></script>
		<script src="lib/client/query_parser.es6.js"></script>
		<script>
			foam.CLASS({
				package: 'org.chromium.apis.web',
				name: 'QueryController',
				extends: 'foam.u2.View',
				implements: ['foam.mlang.Expressions'],

				requires: [
					'org.chromium.parse.GridQueryParser',
					'org.chromium.apis.web.GridRow',
					'foam.u2.search.TextSearchView',
				],

				properties: [
					{
						name: 'predicate',
						factory: function() { return this.TRUE; },
					},
				],

				methods: [
					function initE() {
						this.add(this.TextSearchView.create({
							queryParser: this.GridQueryParser.create({of: this.GridRow}),
							predicate$: this.predicate$,
							of: this.GridRow,
							richSearch: true,
							keywordSearch: true,
						})).add(this.predicate$.map(p => p.toString()));
					},
				],
			});
		</script>
  </head>
  <body>
		<script>
			org.chromium.apis.web.QueryController.create().write(document);
		</script>
  </body>
</html>
